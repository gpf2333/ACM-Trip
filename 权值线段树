#include <bits/stdc++.h>
using namespace std;
#define lson rt << 1
#define rson rt << 1 | 1
#define Lson L, mid, lson
#define Rson mid + 1, R, rson
typedef long long ll;
const int maxn = 2e5 + 100;
ll sum[maxn << 2];
ll cnt[maxn << 2];
int a[maxn];
int b[maxn];
int rmax;
int ans[maxn];
void init()
{
    memset(sum, 0, sizeof(sum));
    memset(cnt, 0, sizeof(cnt));
}
void pushup(int rt)
{
    sum[rt] = sum[lson] + sum[rson];
    cnt[rt] = cnt[lson] + cnt[rson];
}
void update(int l, int r, int rt, int p)
{
    if(l == r)
    {
        ++cnt[rt];
        sum[rt] += b[p];
        return ;
    }
    int mid = (l + r) >> 1;
    if(p <= mid){
        update(l, mid, lson, p);
    }
    else
        update(mid + 1, r, rson, p);
    pushup(rt);
}
ll query(int l, int r, int k, int rt){
    if(l == r) return k >= cnt[rt] ? sum[rt] : sum[rt] / cnt[rt] * k;
    int mid = (l + r) >> 1;
    ll ans = 0;
    if(cnt[rson] >= k) ans += query(mid + 1, r, k, rson);
    else{
        ans += sum[rson];
        ans += query(l, mid, k - cnt[rson], lson);
    }
    return ans;
}
int getid(int x){
    return lower_bound(b + 1, b + 1 + rmax, x) - b;
}
ll Sum[maxn];
int main(){
    int t;
    scanf("%d", &t);
    while(t--){
        int n, m;
        scanf("%d%d", &n, &m);
        init();
        Sum[0] = 0;
        for(int i = 1; i <= n; i++)
        {
            scanf("%d", &a[i]);
            Sum[i] = Sum[i - 1] + a[i];
            b[i] = a[i];
        }
        sort(b + 1, b + 1 + n);
        rmax = unique(b + 1, b + 1 + n) - b - 1;
        for(int i = 1; i <= n; i++){
            if(i == 1){
                ans[i] = 0;
                update(1, rmax, 1, getid(a[i]));
                continue;
            }
            ll l = 0, r = i - 1;
            int anss = r;
            while(l <= r){
                int mid = (l + r) >> 1;
                ll t1 = query(1, rmax, mid, 1);
                if(Sum[i] - t1 <= m){
                    anss = mid;
                    r = mid - 1;
                }
                else
                    l = mid + 1;
            }
            ans[i] = anss;
            update(1, rmax, 1, getid(a[i]));
        }
        for(int i = 1; i <= n; i++) printf("%d ", ans[i]);
        printf("\n");

    }
}
